module.exports=[15857,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(98003),e=a.i(24017),f=a.i(40695),g=a.i(54161),h=a.i(4720),i=a.i(15618),j=a.i(5050),k=(0,j.createServerReference)("001ccba7b7d2b50adcd38dd3ab2f7553350897616d",j.callServer,void 0,j.findSourceMapURL,"getTenders"),l=(0,j.createServerReference)("6062de3f2264d3df3b323fa374a65ccfa0137c09fe",j.callServer,void 0,j.findSourceMapURL,"awardTender"),m=(0,j.createServerReference)("40e9c18829877c36db595b4cfc13390df40a809246",j.callServer,void 0,j.findSourceMapURL,"requestRevisedBids"),n=a.i(36469),o=a.i(33508);function p({tender:a,onClose:c}){if(!a)return null;let d=Array.isArray(a.bids)?[...a.bids]:[];d.sort((a,b)=>{let c="number"==typeof a.score?a.score:0,d="number"==typeof b.score?b.score:0;return d!==c?d-c:("number"==typeof a.totalPrice?a.totalPrice:Number.MAX_SAFE_INTEGER)-("number"==typeof b.totalPrice?b.totalPrice:Number.MAX_SAFE_INTEGER)});let e=a.evaluationSummary||{},h="number"==typeof e.totalBids?e.totalBids:d.length,i="number"==typeof e.disqualified?e.disqualified:0,j="number"==typeof e.score?e.score:void 0;return(0,b.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:c}),(0,b.jsxs)("div",{className:"relative w-full max-w-5xl max-h-[90vh] overflow-y-auto bg-background rounded-lg shadow-2xl mx-4 animate-in fade-in-0 zoom-in-95 duration-200",children:[(0,b.jsxs)("div",{className:"sticky top-0 z-10 bg-background border-b px-6 py-4 flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Tender Scorecard"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[a.tenderId," · ",a.title]})]}),(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",onClick:c,children:(0,b.jsx)(o.X,{className:"h-5 w-5"})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Recommended supplier"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:e.recommendedSupplier||"—"})]}),(0,b.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Overall score"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:void 0!==j?`${j}`:"—"})]}),(0,b.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Total bids"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:h})]}),(0,b.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Disqualified"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:i})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)("h3",{className:"text-sm font-medium",children:"Bid score breakdown"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Sorted by score, then price"})]}),(0,b.jsx)("div",{className:"overflow-x-auto border rounded-lg",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{className:"bg-muted/50 text-xs",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"text-left p-3 font-medium",children:"Supplier"}),(0,b.jsx)("th",{className:"text-left p-3 font-medium",children:"Score"}),(0,b.jsx)("th",{className:"text-left p-3 font-medium",children:"Total price"}),(0,b.jsx)("th",{className:"text-left p-3 font-medium",children:"Compliance"}),(0,b.jsx)("th",{className:"text-left p-3 font-medium",children:"Highlights"})]})}),(0,b.jsx)("tbody",{children:0===d.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{className:"p-4 text-center text-muted-foreground text-xs",colSpan:5,children:"No bids available"})}):d.map((a,c)=>(0,b.jsxs)("tr",{className:"border-t",children:[(0,b.jsx)("td",{className:"p-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-medium",children:a.supplier||"—"}),e.recommendedSupplier&&a.supplier===e.recommendedSupplier&&(0,b.jsx)(g.Badge,{className:"text-xs",children:"Recommended"})]})}),(0,b.jsx)("td",{className:"p-3",children:"number"==typeof a.score?a.score:"—"}),(0,b.jsx)("td",{className:"p-3",children:"number"==typeof a.totalPrice?`$${a.totalPrice.toLocaleString()}`:"—"}),(0,b.jsx)("td",{className:"p-3",children:a.compliance?(0,b.jsx)(g.Badge,{variant:"outline",className:"text-xs",children:a.compliance}):"—"}),(0,b.jsx)("td",{className:"p-3 text-xs text-muted-foreground",children:a.highlights||""})]},c))})]})})]}),(0,b.jsx)("div",{className:"flex items-center justify-end gap-2",children:(0,b.jsx)(f.Button,{variant:"outline",onClick:c,children:"Close"})})]})]})]})}var q=a.i(5522),r=a.i(81560),s=a.i(70106);let t=(0,s.default)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),u=(0,s.default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var v=(0,j.createServerReference)("0049ef1737d2c22db899009076a563749791b888ea",j.callServer,void 0,j.findSourceMapURL,"getTenderTemplates"),w=(0,j.createServerReference)("00502872da77460792324d540806377b4a404bba26",j.callServer,void 0,j.findSourceMapURL,"getEvaluationRules");function x({onClose:a}){let[d,e]=(0,c.useState)("templates"),[h,j]=(0,c.useState)(null),[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)([]),[p,s]=(0,c.useState)(!1),[x,y]=(0,c.useState)({id:"",name:"",description:"",type:"scoring",condition:"",action:"",active:!0});return(0,c.useEffect)(()=>{let a=!0;return Promise.all([v(),w()]).then(([b,c])=>{let d=b?.success?b.data:[],e=c?.success?c.data:[];a&&(l(d),n(e),j(d[0]||null))}).catch(()=>{a&&(l([]),n([]),j(null))}),()=>{a=!1}},[]),(0,b.jsx)("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"bg-card border border-border rounded-lg shadow-lg w-full max-w-6xl max-h-[90vh] flex flex-col",children:[(0,b.jsxs)("div",{className:"border-b border-border p-6 flex items-start justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Templates & Rules Library"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Standardize your sourcing process with reusable templates and automated evaluation rules."})]}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:a,className:"h-8 w-8 p-0",children:(0,b.jsx)(o.X,{className:"h-4 w-4"})})]}),(0,b.jsx)("div",{className:"border-b border-border px-6",children:(0,b.jsxs)("div",{className:"flex gap-6",children:[(0,b.jsxs)("button",{onClick:()=>e("templates"),className:`py-3 text-sm font-medium border-b-2 transition-colors ${"templates"===d?"border-primary text-foreground":"border-transparent text-muted-foreground hover:text-foreground"}`,children:["Tender Templates (",k.length,")"]}),(0,b.jsxs)("button",{onClick:()=>e("rules"),className:`py-3 text-sm font-medium border-b-2 transition-colors ${"rules"===d?"border-primary text-foreground":"border-transparent text-muted-foreground hover:text-foreground"}`,children:["Evaluation Rules (",m.filter(a=>a.active).length," active)"]})]})}),(0,b.jsx)("div",{className:"flex-1 overflow-hidden",children:"templates"===d?(0,b.jsxs)("div",{className:"grid grid-cols-3 h-full divide-x divide-border",children:[(0,b.jsxs)("div",{className:"col-span-1 overflow-y-auto",children:[(0,b.jsx)("div",{className:"p-4 border-b border-border",children:(0,b.jsxs)(f.Button,{size:"sm",className:"w-full",children:[(0,b.jsx)(i.Plus,{className:"w-4 h-4 mr-2"}),"New Template"]})}),(0,b.jsx)("div",{className:"divide-y divide-border",children:k.map(a=>(0,b.jsxs)("button",{onClick:()=>j(a),className:`w-full text-left p-4 hover:bg-accent/50 transition-colors ${h?.id===a.id?"bg-accent":""}`,children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,b.jsx)("div",{className:"font-medium text-sm",children:a.name}),(0,b.jsx)(g.Badge,{variant:"outline",className:"text-xs",children:a.type})]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-2",children:a.category}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Used ",a.usageCount," times"]})]},a.id))})]}),h&&(0,b.jsxs)("div",{className:"col-span-2 overflow-y-auto p-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold mb-1",children:h.name}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:h.description})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(u,{className:"w-4 h-4 mr-2"}),"Duplicate"]}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(t,{className:"w-4 h-4 mr-2"}),"Edit"]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6 p-4 bg-muted/30 rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Type"}),(0,b.jsx)(g.Badge,{children:h.type})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Category"}),(0,b.jsx)("div",{className:"text-sm font-medium",children:h.category})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Usage Count"}),(0,b.jsxs)("div",{className:"text-sm font-medium",children:[h.usageCount," tenders"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Last Updated"}),(0,b.jsx)("div",{className:"text-sm font-medium",children:"2 weeks ago"})]})]}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold mb-3",children:"Scoring Criteria"}),(0,b.jsx)("div",{className:"space-y-3",children:h.scoringCriteria.map(a=>(0,b.jsxs)("div",{className:"border border-border rounded-lg p-3",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium text-sm",children:a.name}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:a.description})]}),(0,b.jsxs)(g.Badge,{className:"bg-primary/10 text-primary",children:[a.weight,"%"]})]}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Score range: ",a.scoreRange.min," -"," ",a.scoreRange.max]})]},a.id))})]}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsxs)("h4",{className:"text-sm font-semibold mb-3",children:["Mandatory Questions (",h.mandatoryQuestions.length,")"]}),(0,b.jsx)("div",{className:"space-y-2",children:h.mandatoryQuestions.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-start gap-3 text-sm p-2 rounded hover:bg-accent/30",children:[(0,b.jsx)("div",{className:"w-5 h-5 rounded-full bg-primary/10 text-primary flex items-center justify-center text-xs font-medium mt-0.5",children:c+1}),(0,b.jsx)("div",{className:"flex-1",children:a})]},c))})]}),(0,b.jsx)("div",{className:"border-t border-border pt-4",children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"sm",children:"Apply to New Tender"}),(0,b.jsx)(f.Button,{variant:"outline",size:"sm",children:"Export Template"}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",className:"text-destructive hover:text-destructive bg-transparent",children:[(0,b.jsx)(r.Trash2,{className:"w-4 h-4 mr-2"}),"Delete"]})]})})]})]}):(0,b.jsxs)("div",{className:"overflow-y-auto p-6",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold mb-1",children:"Evaluation Rules"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Automate scoring, compliance checks, and bid disqualification criteria."})]}),(0,b.jsxs)(f.Button,{size:"sm",onClick:()=>s(a=>!a),children:[(0,b.jsx)(i.Plus,{className:"w-4 h-4 mr-2"}),"New Rule"]})]}),p&&(0,b.jsxs)("div",{className:"border border-border rounded-lg p-4 mb-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Name"}),(0,b.jsx)(q.Input,{value:x.name,onChange:a=>y({...x,name:a.target.value}),placeholder:"e.g. Minimum Score Threshold"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Type"}),(0,b.jsxs)("select",{className:"w-full rounded-md border border-border bg-background p-2 text-sm",value:x.type,onChange:a=>y({...x,type:a.target.value}),children:[(0,b.jsx)("option",{value:"scoring",children:"scoring"}),(0,b.jsx)("option",{value:"compliance",children:"compliance"}),(0,b.jsx)("option",{value:"disqualification",children:"disqualification"})]})]}),(0,b.jsxs)("div",{className:"sm:col-span-2",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Description"}),(0,b.jsx)("textarea",{className:"w-full rounded-md border border-border bg-background p-2 text-sm",rows:2,value:x.description,onChange:a=>y({...x,description:a.target.value}),placeholder:"Short explanation of the rule"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Condition"}),(0,b.jsx)(q.Input,{value:x.condition,onChange:a=>y({...x,condition:a.target.value}),placeholder:"e.g. Total score < 60"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Action"}),(0,b.jsx)(q.Input,{value:x.action,onChange:a=>y({...x,action:a.target.value}),placeholder:"e.g. Automatic disqualification"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{id:"rule-active",type:"checkbox",className:"h-4 w-4",checked:x.active,onChange:a=>y({...x,active:a.target.checked})}),(0,b.jsx)("label",{htmlFor:"rule-active",className:"text-sm",children:"Active"})]})]}),(0,b.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>{y({id:"",name:"",description:"",type:"scoring",condition:"",action:"",active:!0}),s(!1)},children:"Cancel"}),(0,b.jsx)(f.Button,{size:"sm",onClick:()=>{let a=Date.now().toString(),b={...x,id:a};n(a=>[b,...a]),j(a=>a),y({id:"",name:"",description:"",type:"scoring",condition:"",action:"",active:!0}),s(!1)},children:"Save Rule"})]})]})]}),["scoring","compliance","disqualification"].map(a=>{let c=m.filter(b=>b.type===a);return(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsxs)("h4",{className:"text-sm font-semibold mb-3 capitalize",children:[a," Rules (",c.length,")"]}),(0,b.jsx)("div",{className:"space-y-3",children:c.map(a=>(0,b.jsxs)("div",{className:"border border-border rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("div",{className:"font-medium text-sm",children:a.name}),a.active?(0,b.jsx)(g.Badge,{className:"bg-success/20 text-success-foreground text-xs",children:"Active"}):(0,b.jsx)(g.Badge,{variant:"outline",className:"text-xs",children:"Inactive"})]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.description})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",children:(0,b.jsx)(t,{className:"w-4 h-4"})}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",children:(0,b.jsx)(r.Trash2,{className:"w-4 h-4 text-destructive"})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-muted-foreground mb-1",children:"Condition"}),(0,b.jsx)("div",{className:"font-mono bg-muted/50 p-2 rounded",children:a.condition})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-muted-foreground mb-1",children:"Action"}),(0,b.jsx)("div",{className:"font-mono bg-muted/50 p-2 rounded",children:a.action})]})]})]},a.id))})]},a)})]})}),(0,b.jsxs)("div",{className:"border-t border-border p-4 flex items-center justify-between",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"templates"===d?"Templates help standardize tender creation and ensure consistent evaluation criteria.":"Rules automatically enforce compliance and scoring logic across all tenders."}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:a,children:"Close"}),(0,b.jsx)(f.Button,{size:"sm",children:"Save Changes"})]})]})]})})}var y=a.i(95245),z=a.i(65733),A=a.i(11011),B=a.i(97895),C=a.i(17171);let D=y.FormProvider,E=c.createContext({}),F=({...a})=>(0,b.jsx)(E.Provider,{value:{name:a.name},children:(0,b.jsx)(y.Controller,{...a})}),G=()=>{let a=c.useContext(E),b=c.useContext(H),{getFieldState:d}=(0,y.useFormContext)(),e=(0,y.useFormState)({name:a.name}),f=d(a.name,e);if(!a)throw Error("useFormField should be used within <FormField>");let{id:g}=b;return{id:g,name:a.name,formItemId:`${g}-form-item`,formDescriptionId:`${g}-form-item-description`,formMessageId:`${g}-form-item-message`,...f}},H=c.createContext({});function I({className:a,...d}){let e=c.useId();return(0,b.jsx)(H.Provider,{value:{id:e},children:(0,b.jsx)("div",{"data-slot":"form-item",className:(0,B.cn)("grid gap-2",a),...d})})}function J({className:a,...c}){let{error:d,formItemId:e}=G();return(0,b.jsx)(C.Label,{"data-slot":"form-label","data-error":!!d,className:(0,B.cn)("data-[error=true]:text-destructive",a),htmlFor:e,...c})}function K({...a}){let{error:c,formItemId:d,formDescriptionId:e,formMessageId:f}=G();return(0,b.jsx)(A.Slot,{"data-slot":"form-control",id:d,"aria-describedby":c?`${e} ${f}`:`${e}`,"aria-invalid":!!c,...a})}function L({className:a,...c}){let{formDescriptionId:d}=G();return(0,b.jsx)("p",{"data-slot":"form-description",id:d,className:(0,B.cn)("text-muted-foreground text-sm",a),...c})}function M({className:a,...c}){let{error:d,formMessageId:e}=G(),f=d?String(d?.message??""):c.children;return f?(0,b.jsx)("p",{"data-slot":"form-message",id:e,className:(0,B.cn)("text-destructive text-sm",a),...c,children:f}):null}var N=a.i(46893),O=(0,j.createServerReference)("60289e77b7cac64e0b615dd6de32d908e8396880ef",j.callServer,void 0,j.findSourceMapURL,"submitBid");function P({tender:a,onClose:d}){let[e,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(null),l=(0,y.useForm)({defaultValues:{supplierName:"",contactEmail:"",contactPhone:"",totalPrice:"",deliveryTimeline:"",complianceStatement:"",additionalNotes:""}}),m=async b=>{g(!0);try{async function c(a,b){if(!a||0===a.length)return[];let c=new FormData;Array.from(a).filter(a=>"application/pdf"===a.type||String(a.name||"").toLowerCase().endsWith(".pdf")).forEach(a=>c.append("files",a)),c.append("folder",b);let d=await fetch("/api/upload",{method:"POST",body:c}),e=await d.json();return e&&e.success?e.data:[]}let e=await c(h,`tenders/${a.tenderId}/technical`),f=await c(j,`tenders/${a.tenderId}/financial`),g=await O(String(a._id),{supplierName:b.supplierName,contactEmail:b.contactEmail,contactPhone:b.contactPhone,totalPrice:b.totalPrice,deliveryTimeline:b.deliveryTimeline,complianceStatement:b.complianceStatement,additionalNotes:b.additionalNotes,technicalProposalUploads:e,financialProposalUploads:f});g&&g.success?d():console.error(g?.error||"Failed to submit bid")}catch(a){console.error("Failed to submit bid",a)}finally{g(!1)}};return(0,b.jsx)(z.Dialog,{open:!0,onOpenChange:d,children:(0,b.jsxs)(z.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(z.DialogHeader,{children:[(0,b.jsxs)(z.DialogTitle,{children:["Submit Bid for ",a.tenderId]}),(0,b.jsxs)(z.DialogDescription,{children:[a.title," · Closes on"," ",new Date(a.closeDate).toLocaleDateString()]})]}),(0,b.jsx)(D,{...l,children:(0,b.jsxs)("form",{onSubmit:l.handleSubmit(m),className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium",children:"Supplier Information"}),(0,b.jsx)(F,{control:l.control,name:"supplierName",render:({field:a})=>(0,b.jsxs)(I,{children:[(0,b.jsx)(J,{children:"Supplier Name"}),(0,b.jsx)(K,{children:(0,b.jsx)(q.Input,{placeholder:"Enter your company name",...a})}),(0,b.jsx)(M,{})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(F,{control:l.control,name:"contactEmail",render:({field:a})=>(0,b.jsxs)(I,{children:[(0,b.jsx)(J,{children:"Contact Email"}),(0,b.jsx)(K,{children:(0,b.jsx)(q.Input,{type:"email",placeholder:"email@example.com",...a})}),(0,b.jsx)(M,{})]})}),(0,b.jsx)(F,{control:l.control,name:"contactPhone",render:({field:a})=>(0,b.jsxs)(I,{children:[(0,b.jsx)(J,{children:"Contact Phone"}),(0,b.jsx)(K,{children:(0,b.jsx)(q.Input,{placeholder:"+1 (555) 000-0000",...a})}),(0,b.jsx)(M,{})]})})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium",children:"Commercial Proposal"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(F,{control:l.control,name:"totalPrice",render:({field:a})=>(0,b.jsxs)(I,{children:[(0,b.jsx)(J,{children:"Total Price (per year)"}),(0,b.jsx)(K,{children:(0,b.jsx)(q.Input,{placeholder:"$0.00",...a})}),(0,b.jsx)(L,{children:"Enter your total annual price"}),(0,b.jsx)(M,{})]})}),(0,b.jsx)(F,{control:l.control,name:"deliveryTimeline",render:({field:a})=>(0,b.jsxs)(I,{children:[(0,b.jsx)(J,{children:"Delivery Timeline"}),(0,b.jsx)(K,{children:(0,b.jsx)(q.Input,{placeholder:"e.g., 4-6 weeks",...a})}),(0,b.jsx)(L,{children:"Expected delivery timeframe"}),(0,b.jsx)(M,{})]})})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium",children:"Upload bids document"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(J,{children:"Technical proposal document"}),(0,b.jsx)(q.Input,{type:"file",multiple:!0,accept:"application/pdf,.pdf",onChange:a=>i(a.target.files)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(J,{children:"Financial proposal document"}),(0,b.jsx)(q.Input,{type:"file",multiple:!0,accept:"application/pdf,.pdf",onChange:a=>k(a.target.files)})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium",children:"Technical & Compliance"}),(0,b.jsx)(F,{control:l.control,name:"complianceStatement",render:({field:a})=>(0,b.jsxs)(I,{children:[(0,b.jsx)(J,{children:"Compliance Statement"}),(0,b.jsx)(K,{children:(0,b.jsx)(N.Textarea,{placeholder:"Confirm compliance with requirements, certifications, and standards...",className:"min-h-[80px]",...a})}),(0,b.jsx)(M,{})]})}),(0,b.jsx)(F,{control:l.control,name:"additionalNotes",render:({field:a})=>(0,b.jsxs)(I,{children:[(0,b.jsx)(J,{children:"Additional Notes (Optional)"}),(0,b.jsx)(K,{children:(0,b.jsx)(N.Textarea,{placeholder:"Any additional information or special considerations...",className:"min-h-[80px]",...a})}),(0,b.jsx)(M,{})]})})]}),(0,b.jsxs)(z.DialogFooter,{children:[(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:d,children:"Cancel"}),(0,b.jsx)(f.Button,{type:"submit",disabled:e,children:e?"Submitting...":"Submit Bid"})]})]})})]})})}function Q(){let[a,j]=(0,c.useState)([]),[o,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(!0),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(!1),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(!1),{user:C}=(0,d.useUser)(),[D,E]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{!async function(){let a=await k();a.success&&(j(a.data),a.data.length>0&&q(a.data[0])),s(!1)}()},[]),(0,c.useEffect)(()=>{E(["admin","company","superadmin"].includes(String((C?.publicMetadata||{}).role||"").toLowerCase().replace(/[\s_-]/g,"")))},[C]),(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"max-w-[1600px] mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold text-foreground mb-2",children:"Tenders"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Plan, publish, and evaluate sourcing events across your organization."})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>z(!0),children:[(0,b.jsx)(h.FileText,{className:"w-4 h-4 mr-2"}),"Templates & rules"]}),D&&(0,b.jsxs)(f.Button,{size:"sm",onClick:()=>u(!0),children:[(0,b.jsx)(i.Plus,{className:"w-4 h-4 mr-2"}),"New tender"]})]})]}),(0,b.jsxs)("div",{className:"bg-card border border-border rounded-lg p-4 mb-6",children:[(0,b.jsxs)("div",{className:"flex flex-wrap gap-6 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"View:"})," ",(0,b.jsx)("span",{className:"font-medium",children:"Active & in evaluation"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Stage:"})," ",(0,b.jsx)("span",{className:"font-medium",children:"Open, Evaluation"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Type:"})," ",(0,b.jsx)("span",{className:"font-medium",children:"RFP, RFQ"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Region:"})," ",(0,b.jsx)("span",{className:"font-medium",children:"Global, APAC"})]})]}),(0,b.jsxs)("div",{className:"flex gap-4 mt-3 text-xs text-muted-foreground",children:[(0,b.jsx)("span",{children:"6 open tenders"}),(0,b.jsx)("span",{children:"2 in final evaluation"}),(0,b.jsx)("span",{children:"Avg. 4.3 bids per tender"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-5 gap-6",children:[(0,b.jsxs)("div",{className:"col-span-2 bg-card border border-border rounded-lg",children:[(0,b.jsxs)("div",{className:"border-b border-border p-4 flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"font-medium",children:"Sourcing pipeline"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Select a tender to review participation and evaluation."})]}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"Sorted by close date"})]}),(0,b.jsx)("div",{className:"divide-y divide-border",children:r?(0,b.jsx)("div",{className:"p-8 text-center text-muted-foreground text-sm",children:"Loading tenders..."}):0===a.length?(0,b.jsx)("div",{className:"p-8 text-center text-muted-foreground text-sm",children:"No tenders found. Connect to MongoDB to see data."}):a.map(a=>(0,b.jsxs)("button",{onClick:()=>q(a),className:`w-full text-left p-4 hover:bg-accent/50 transition-colors ${o?._id===a._id?"bg-accent":""}`,children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"font-medium text-sm mb-1",children:a.tenderId}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-2",children:a.title}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(g.Badge,{variant:"outline",className:"text-xs",children:a.type}),(0,b.jsx)(e.StatusBadge,{status:a.stage||a.status})]})]}),(0,b.jsx)("div",{className:"text-right text-xs text-muted-foreground",children:(0,b.jsxs)("div",{children:[a.bids?.length||0," responses"]})})]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:new Date(a.closeDate).toLocaleDateString()})]},a._id))}),(0,b.jsx)("div",{className:"p-3 border-t border-border text-xs text-muted-foreground",children:'Tip: Use "Templates & rules" to standardize scoring and mandatory questions.'})]}),o&&(0,b.jsxs)("div",{className:"col-span-3 bg-card border border-border rounded-lg",children:[(0,b.jsxs)("div",{className:"border-b border-border p-4 flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"font-medium",children:[o.tenderId," · ",o.title]}),(0,b.jsxs)("div",{className:"flex gap-4 text-xs text-muted-foreground mt-1",children:[(0,b.jsxs)("span",{children:["Owner: ",o.owner]}),(0,b.jsxs)("span",{children:["Category: ",o.category]})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)(e.StatusBadge,{status:o.stage||o.status}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:"Draft evaluation"})]})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[("RFQ"===o.type||"RFP"===o.type)&&(0,b.jsx)("div",{className:"bg-accent/30 border border-border rounded-lg p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium mb-1",children:"Supplier Bidding"}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Submit your bid for this ",o.type," before the closing date"]})]}),(0,b.jsx)(f.Button,{onClick:()=>{B(!0)},children:"Submit Bid"})]})}),(0,b.jsxs)("div",{className:"flex gap-4 text-xs",children:[(0,b.jsxs)("span",{children:["Business unit: ",o.businessUnit]}),(0,b.jsxs)("span",{children:["Region: ",o.region]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium mb-3",children:"Overview & key details"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-muted-foreground text-xs mb-1",children:"Sourcing objective"}),(0,b.jsx)("div",{children:o.sourcingObjective})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-muted-foreground text-xs mb-1",children:"Estimated contract value"}),(0,b.jsx)("div",{className:"font-medium",children:o.estimatedContractValue})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-muted-foreground text-xs mb-1",children:"Sourcing type"}),(0,b.jsx)("div",{children:o.sourcingType})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-muted-foreground text-xs mb-1",children:"Key dates"}),(0,b.jsxs)("div",{children:["Published:"," ",new Date(o.publishedDate).toLocaleDateString()," ","· Closed:"," ",new Date(o.closeDate).toLocaleDateString()]})]})]})]}),"evaluation"===String(o.stage||o.status).toLowerCase()&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium mb-3",children:"Evaluation summary"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-muted-foreground text-xs mb-1",children:"Recommended supplier"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-medium",children:o.recommendedSupplier}),(0,b.jsxs)(g.Badge,{className:"bg-success/20 text-success-foreground",children:["Score: ",o.recommendedSupplierScore," / 100"]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-muted-foreground text-xs mb-1",children:"Total evaluated bids"}),(0,b.jsxs)("div",{className:"font-medium",children:[o.bids?.length||0," bids ·"," ",o.disqualifiedBids||0," disqualified"]})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)("h3",{className:"text-sm font-medium",children:"Commercial comparison"}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Best offer:"," ",(0,b.jsxs)("span",{className:"font-medium",children:[o.bestOfferPrice," / year"]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)("h3",{className:"text-sm font-medium",children:"Risk & compliance"}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:[(0,b.jsx)("span",{className:"font-medium",children:o.infoRisks})," ","· ",o.criticalIssues," critical issues"]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium mb-3",children:"Bids & scoring comparison"}),(0,b.jsx)("div",{className:"border border-border rounded-lg overflow-hidden",children:(0,b.jsxs)("table",{className:"w-full text-xs",children:[(0,b.jsx)("thead",{className:"bg-muted/50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"text-left p-3 font-medium",children:"Supplier"}),(0,b.jsx)("th",{className:"text-right p-3 font-medium",children:"Total price / year"}),(0,b.jsx)("th",{className:"text-center p-3 font-medium",children:"Score"}),(0,b.jsx)("th",{className:"text-center p-3 font-medium",children:"Compliance"}),(0,b.jsx)("th",{className:"text-left p-3 font-medium",children:"Highlights"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-border",children:o.bids?.map((a,c)=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"p-3 font-medium",children:a.supplier}),(0,b.jsx)("td",{className:"p-3 text-right",children:a.price}),(0,b.jsx)("td",{className:"p-3 text-center",children:(0,b.jsx)(g.Badge,{className:0===c?"bg-success/20 text-success-foreground":"bg-muted",children:a.score})}),(0,b.jsx)("td",{className:"p-3 text-center",children:(0,b.jsx)("span",{className:0===c?"text-success":"",children:a.compliance})}),(0,b.jsx)("td",{className:"p-3 text-muted-foreground",children:a.highlights})]},c))})]})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Timeline & governance"}),(0,b.jsx)("div",{className:"space-y-3",children:o.timeline?.map((a,c)=>(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-primary mt-1.5"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:a.title}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:[a.date&&`${a.date} \xb7 `,a.detail]})]})]},c))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Notes & attachments"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mb-4",children:o.notes})]}),(0,b.jsxs)("div",{className:"border-t border-border pt-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Next actions"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mb-4",children:"Confirm your recommendation; award details will be shared with suppliers and downstream teams."}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>w(!0),children:"View full scorecard"}),(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:async()=>{await m(o._id);let a=await k();a.success&&(j(a.data),q(a.data.find(a=>a._id===o._id)||a.data[0]))},children:"Request revised bids"}),(0,b.jsx)(f.Button,{size:"sm",onClick:async()=>{await l(o._id,o.recommendedSupplier);let a=await k();a.success&&(j(a.data),q(a.data.find(a=>a._id===o._id)||a.data[0]))},children:"Award tender"})]})]})]})]})]})]}),(0,b.jsx)("footer",{className:"border-t border-border p-4 flex items-center justify-between text-xs text-muted-foreground",children:(0,b.jsxs)("div",{className:"flex gap-6",children:[(0,b.jsxs)("span",{children:["Branch: ",(0,b.jsx)("span",{className:"text-primary",children:"Global HQ"})]}),(0,b.jsxs)("span",{children:["FY24 Budget Utilization:"," ",(0,b.jsx)("span",{className:"font-medium",children:"68% used"})]})]})}),t&&(0,b.jsx)(n.CreateTenderForm,{onClose:()=>u(!1)}),v&&o&&(0,b.jsx)(p,{tender:o,onClose:()=>w(!1)}),y&&(0,b.jsx)(x,{onClose:()=>z(!1)}),A&&o&&(0,b.jsx)(P,{tender:o,onClose:()=>B(!1)})]})}a.s(["default",()=>Q],15857)}];

//# sourceMappingURL=app_%28app%29_tenders_page_tsx_0d7a6c34._.js.map