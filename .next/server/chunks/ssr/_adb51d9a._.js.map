{"version":3,"sources":["../../../../lib/models/Supplier.ts","../../../../lib/actions/supplier-actions.ts","../../../../node_modules/%40clerk/nextjs/dist/esm/app-router/server-actions.js","../../../../.next-internal/server/app/%28app%29/reports/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["import mongoose, { Schema, model, models } from 'mongoose'\n\nconst SupplierSchema = new Schema({\n  supplierId: { type: String, required: true, unique: true },\n  name: { type: String, required: true },\n  approved: { type: Boolean, default: false },\n  ownerUserId: { type: String, required: true, index: true },\n  segment: { type: String },\n  category: { type: String },\n  region: { type: String },\n  onboarding: {\n    contactPerson: String,\n    phone: String,\n    email: String,\n    goodsType: String,\n    productCategories: [String],\n    supplyAreas: [String],\n    deliveryTimeline: String,\n    priceListUploads: [{ name: String, size: Number, type: String }],\n    registrationCertificateUploads: [{ name: String, size: Number, type: String }],\n    businessRegistrationCertificateUploads: [{ name: String, size: Number, type: String }],\n    taxClearanceCertificateUploads: [{ name: String, size: Number, type: String }],\n    gstVatRegistrationCertificateUploads: [{ name: String, size: Number, type: String }],\n    businessLicenseUploads: [{ name: String, size: Number, type: String }],\n    nassitCertificateUploads: [{ name: String, size: Number, type: String }],\n    sectorSpecificCertificateUploads: [{ name: String, size: Number, type: String }],\n    paymentMethods: [String],\n    bankDetails: {\n      bankName: String,\n      accountName: String,\n      accountNumber: String,\n      prefersCash: Boolean,\n    },\n    declarations: {\n      infoAccurate: Boolean,\n      agreeRules: Boolean,\n    },\n  },\n  risk: { \n    type: String, \n    enum: ['Low', 'Medium', 'High', 'Under review']\n  },\n  onTimePerformance: { type: Number },\n  fy24Spend: { type: Number },\n  performanceScore: { type: Number },\n  riskStatus: { type: String },\n  primaryCategory: { type: String },\n  commercialTerms: {\n    paymentTerms: String,\n    diversityStatus: String\n  },\n  performanceMetrics: {\n    deliveryPerformance: {\n      onTime: Number,\n      avgLeadTime: Number,\n      lateDeliveries: Number\n    },\n    qualityMetrics: {\n      returnRate: Number,\n      qualityIncidents: Number,\n      criticalEvents: Number\n    },\n    financialMetrics: {\n      externalRating: String,\n      creditLimit: Number,\n      overdueInvoices: Boolean,\n      paymentAge: Number\n    },\n    complianceStatus: {\n      kyc: String,\n      aml: String,\n      insuranceCerts: Boolean,\n      sanctions: String\n    }\n  },\n  contacts: [{\n    role: String,\n    name: String,\n    email: String,\n    phone: String\n  }],\n  documents: [{\n    name: String,\n    type: String,\n    size: String,\n    signedDate: String,\n    expiresDate: String,\n    owner: String\n  }],\n  recentActivity: [{\n    event: String,\n    date: String,\n    owner: String\n  }]\n}, { timestamps: true })\n\nexport const Supplier = models.Supplier || model('Supplier', SupplierSchema)\n","'use server'\n\nimport { revalidatePath } from 'next/cache'\nimport dbConnect from '@/lib/mongodb'\nimport { Supplier } from '../models/Supplier'\n\nexport async function getSuppliers() {\n  try {\n    await dbConnect()\n    const suppliers = await Supplier.find({ approved: true })\n      .sort({ performanceScore: -1 })\n      .limit(50)\n      .lean()\n    \n    return { \n      success: true, \n      data: JSON.parse(JSON.stringify(suppliers))\n    }\n  } catch (error) {\n    console.error('[v0] Error fetching suppliers:', error)\n    return { success: false, error: 'Failed to fetch suppliers' }\n  }\n}\n\nexport async function getSupplierById(id: string) {\n  try {\n    await dbConnect()\n    const supplier = await Supplier.findById(id).lean()\n    \n    if (!supplier) {\n      return { success: false, error: 'Supplier not found' }\n    }\n    \n    return { \n      success: true, \n      data: JSON.parse(JSON.stringify(supplier))\n    }\n  } catch (error) {\n    console.error('[v0] Error fetching supplier:', error)\n    return { success: false, error: 'Failed to fetch supplier' }\n  }\n}\n\nexport async function createSupplier(data: any) {\n  try {\n    await dbConnect()\n    \n    const supplier = await Supplier.create(data)\n    revalidatePath('/suppliers')\n    \n    return { \n      success: true, \n      data: JSON.parse(JSON.stringify(supplier))\n    }\n  } catch (error) {\n    console.error('[v0] Error creating supplier:', error)\n    return { success: false, error: 'Failed to create supplier' }\n  }\n}\n\nexport async function updateSupplier(id: string, updates: any) {\n  try {\n    await dbConnect()\n    \n    const supplier = await Supplier.findByIdAndUpdate(\n      id,\n      updates,\n      { new: true }\n    ).lean()\n    \n    if (!supplier) {\n      return { success: false, error: 'Supplier not found' }\n    }\n    \n    revalidatePath('/suppliers')\n    revalidatePath(`/suppliers/${id}`)\n    \n    return { \n      success: true, \n      data: JSON.parse(JSON.stringify(supplier))\n    }\n  } catch (error) {\n    console.error('[v0] Error updating supplier:', error)\n    return { success: false, error: 'Failed to update supplier' }\n  }\n}\n\nexport async function deleteSupplier(id: string) {\n  try {\n    await dbConnect()\n    \n    const supplier = await Supplier.findByIdAndDelete(id)\n    \n    if (!supplier) {\n      return { success: false, error: 'Supplier not found' }\n    }\n    \n    revalidatePath('/suppliers')\n    \n    return { success: true }\n  } catch (error) {\n    console.error('[v0] Error deleting supplier:', error)\n    return { success: false, error: 'Failed to delete supplier' }\n  }\n}\n","\"use server\";\nimport { cookies } from \"next/headers\";\nasync function invalidateCacheAction() {\n  void (await cookies()).delete(`__clerk_invalidate_cache_cookie_${Date.now()}`);\n}\nexport {\n  invalidateCacheAction\n};\n","export {detectKeylessEnvDriftAction as '7f1dbd68cb8e312051904c740c31183700f8d1735b'} from 'ACTIONS_MODULE0'\nexport {invalidateCacheAction as '7f7028896c8082e0c1f396f4d9a06959ec42b1d08a'} from 'ACTIONS_MODULE1'\nexport {createOrReadKeylessAction as '7f8d998a6efbd0c4b96f44e255714ffadbe9a58ab2'} from 'ACTIONS_MODULE0'\nexport {formatMetadataHeaders as '7f770e265b733918dbea7c626386b020f2422cfea4'} from 'ACTIONS_MODULE2'\nexport {collectKeylessMetadata as '7fcb3eace087d4a182205618daa34bbc74fd3410aa'} from 'ACTIONS_MODULE2'\nexport {deleteKeylessAction as '7f07616d1842b196e75d3764badc0c908a989af9f9'} from 'ACTIONS_MODULE0'\nexport {detectKeylessEnvDriftAction as '7f1dbd68cb8e312051904c740c31183700f8d1735b'} from 'ACTIONS_MODULE0'\nexport {syncKeylessConfigAction as '7f1ede8bc9d9446f8123ff7d3c19d928c3e8517cde'} from 'ACTIONS_MODULE0'\nexport {createOrReadKeylessAction as '7f8d998a6efbd0c4b96f44e255714ffadbe9a58ab2'} from 'ACTIONS_MODULE0'\nexport {deleteKeylessAction as '7f07616d1842b196e75d3764badc0c908a989af9f9'} from 'ACTIONS_MODULE0'\nexport {syncKeylessConfigAction as '7f1ede8bc9d9446f8123ff7d3c19d928c3e8517cde'} from 'ACTIONS_MODULE0'\nexport {getNotifications as '4038dfb1dece52774e405a3da827c0072c4eb6aa73'} from 'ACTIONS_MODULE3'\nexport {getUnreadCount as '00e7b4a1c132478642418d345503f4c53bdb390c9c'} from 'ACTIONS_MODULE3'\nexport {markAsRead as '4012a4770a5fca10e2a3ff1d52fc6907455ac5eee8'} from 'ACTIONS_MODULE3'\nexport {markAllAsRead as '002a32689d17cb2cb93efe0d9a0dde8c0edec41c9c'} from 'ACTIONS_MODULE3'\nexport {deleteNotification as '4063e6dc301d47e91bde494afbc0d7a04d3079b4db'} from 'ACTIONS_MODULE3'\nexport {getRequisitions as '00f4030896116c02808b53faf984df59a1de335173'} from 'ACTIONS_MODULE4'\nexport {getPurchaseOrders as '00e9a018658eb7e03331b6cc284e99f89a37d0d11b'} from 'ACTIONS_MODULE5'\nexport {getSuppliers as '00acbb6e695774d924e05f0e0a179080700111a9b9'} from 'ACTIONS_MODULE6'\nexport {getInvoices as '00edf2497aa68ccbd564b9525e653a469b4a592936'} from 'ACTIONS_MODULE7'\nexport {getApprovals as '00be20e6109a2a8bfeb45dc52d89ce9cb3529fad93'} from 'ACTIONS_MODULE8'\n"],"names":[],"mappings":"uCAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OAEA,IAAM,EAAiB,IAAI,EAAA,MAAM,CAAC,CAChC,WAAY,CAAE,KAAM,OAAQ,UAAU,EAAM,QAAQ,CAAK,EACzD,KAAM,CAAE,KAAM,OAAQ,UAAU,CAAK,EACrC,SAAU,CAAE,KAAM,QAAS,SAAS,CAAM,EAC1C,YAAa,CAAE,KAAM,OAAQ,UAAU,EAAM,OAAO,CAAK,EACzD,QAAS,CAAE,KAAM,MAAO,EACxB,SAAU,CAAE,KAAM,MAAO,EACzB,OAAQ,CAAE,KAAM,MAAO,EACvB,WAAY,CACV,cAAe,OACf,MAAO,OACP,MAAO,OACP,UAAW,OACX,kBAAmB,CAAC,OAAO,CAC3B,YAAa,CAAC,OAAO,CACrB,iBAAkB,OAClB,iBAAkB,CAAC,CAAE,KAAM,OAAQ,KAAM,OAAQ,KAAM,MAAO,EAAE,CAChE,+BAAgC,CAAC,CAAE,KAAM,OAAQ,KAAM,OAAQ,KAAM,MAAO,EAAE,CAC9E,uCAAwC,CAAC,CAAE,KAAM,OAAQ,KAAM,OAAQ,KAAM,MAAO,EAAE,CACtF,+BAAgC,CAAC,CAAE,KAAM,OAAQ,KAAM,OAAQ,KAAM,MAAO,EAAE,CAC9E,qCAAsC,CAAC,CAAE,KAAM,OAAQ,KAAM,OAAQ,KAAM,MAAO,EAAE,CACpF,uBAAwB,CAAC,CAAE,KAAM,OAAQ,KAAM,OAAQ,KAAM,MAAO,EAAE,CACtE,yBAA0B,CAAC,CAAE,KAAM,OAAQ,KAAM,OAAQ,KAAM,MAAO,EAAE,CACxE,iCAAkC,CAAC,CAAE,KAAM,OAAQ,KAAM,OAAQ,KAAM,MAAO,EAAE,CAChF,eAAgB,CAAC,OAAO,CACxB,YAAa,CACX,SAAU,OACV,YAAa,OACb,cAAe,OACf,YAAa,OACf,EACA,aAAc,CACZ,aAAc,QACd,WAAY,OACd,CACF,EACA,KAAM,CACJ,KAAM,OACN,KAAM,CAAC,MAAO,SAAU,OAAQ,eAAe,AACjD,EACA,kBAAmB,CAAE,KAAM,MAAO,EAClC,UAAW,CAAE,KAAM,MAAO,EAC1B,iBAAkB,CAAE,KAAM,MAAO,EACjC,WAAY,CAAE,KAAM,MAAO,EAC3B,gBAAiB,CAAE,KAAM,MAAO,EAChC,gBAAiB,CACf,aAAc,OACd,gBAAiB,MACnB,EACA,mBAAoB,CAClB,oBAAqB,CACnB,OAAQ,OACR,YAAa,OACb,eAAgB,MAClB,EACA,eAAgB,CACd,WAAY,OACZ,iBAAkB,OAClB,eAAgB,MAClB,EACA,iBAAkB,CAChB,eAAgB,OAChB,YAAa,OACb,gBAAiB,QACjB,WAAY,MACd,EACA,iBAAkB,CAChB,IAAK,OACL,IAAK,OACL,eAAgB,QAChB,UAAW,MACb,CACF,EACA,SAAU,CAAC,CACT,KAAM,OACN,KAAM,OACN,MAAO,OACP,MAAO,MACT,EAAE,CACF,UAAW,CAAC,CACV,KAAM,OACN,KAAM,OACN,KAAM,OACN,WAAY,OACZ,YAAa,OACb,MAAO,MACT,EAAE,CACF,eAAgB,CAAC,CACf,MAAO,OACP,KAAM,OACN,MAAO,MACT,EAAE,AACJ,EAAG,CAAE,YAAY,CAAK,GAET,EAAW,EAAA,MAAM,CAAC,QAAQ,EAAI,CAAA,EAAA,EAAA,KAAK,AAAL,EAAM,WAAY,kEC9F7D,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEO,eAAe,IACpB,GAAI,CACF,MAAM,CAAA,EAAA,EAAA,OAAA,AAAS,IACf,IAAM,EAAY,MAAM,EAAA,QAAQ,CAAC,IAAI,CAAC,CAAE,UAAU,CAAK,GACpD,IAAI,CAAC,CAAE,iBAAkB,CAAC,CAAE,GAC5B,KAAK,CAAC,IACN,IAAI,GAEP,MAAO,CACL,SAAS,EACT,KAAM,KAAK,KAAK,CAAC,KAAK,SAAS,CAAC,GAClC,CACF,CAAE,MAAO,EAAO,CAEd,OADA,QAAQ,KAAK,CAAC,iCAAkC,GACzC,CAAE,SAAS,EAAO,MAAO,2BAA4B,CAC9D,CACF,CAEO,eAAe,EAAgB,CAAU,EAC9C,GAAI,CACF,MAAM,CAAA,EAAA,EAAA,OAAA,AAAS,IACf,IAAM,EAAW,MAAM,EAAA,QAAQ,CAAC,QAAQ,CAAC,GAAI,IAAI,GAEjD,GAAI,CAAC,EACH,MAAO,CAAE,CADI,QACK,EAAO,MAAO,oBAAqB,EAGvD,MAAO,CACL,SAAS,EACT,KAAM,KAAK,KAAK,CAAC,KAAK,SAAS,CAAC,GAClC,CACF,CAAE,MAAO,EAAO,CAEd,OADA,QAAQ,KAAK,CAAC,gCAAiC,GACxC,CAAE,SAAS,EAAO,MAAO,0BAA2B,CAC7D,CACF,CAEO,eAAe,EAAe,CAAS,EAC5C,GAAI,CACF,MAAM,CAAA,EAAA,EAAA,OAAA,AAAS,IAEf,IAAM,EAAW,MAAM,EAAA,QAAQ,CAAC,MAAM,CAAC,GAGvC,MAFA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,cAER,CACL,SAAS,EACT,KAAM,KAAK,KAAK,CAAC,KAAK,SAAS,CAAC,GAClC,CACF,CAAE,MAAO,EAAO,CAEd,OADA,QAAQ,KAAK,CAAC,gCAAiC,GACxC,CAAE,SAAS,EAAO,MAAO,2BAA4B,CAC9D,CACF,CAEO,eAAe,EAAe,CAAU,CAAE,CAAY,EAC3D,GAAI,CACF,MAAM,CAAA,EAAA,EAAA,OAAA,AAAS,IAEf,IAAM,EAAW,MAAM,EAAA,QAAQ,CAAC,iBAAiB,CAC/C,EACA,EACA,CAAE,KAAK,CAAK,GACZ,IAAI,GAEN,GAAI,CAAC,EACH,MAAO,CAAE,CADI,OACK,GAAO,MAAO,oBAAqB,EAMvD,MAHA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,cACf,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,CAAC,WAAW,EAAE,EAAA,CAAI,EAE1B,CACL,SAAS,EACT,KAAM,KAAK,KAAK,CAAC,KAAK,SAAS,CAAC,GAClC,CACF,CAAE,MAAO,EAAO,CAEd,OADA,QAAQ,KAAK,CAAC,gCAAiC,GACxC,CAAE,SAAS,EAAO,MAAO,2BAA4B,CAC9D,CACF,CAEO,eAAe,EAAe,CAAU,EAC7C,GAAI,CAKF,GAJA,MAAM,CAAA,EAAA,EAAA,OAAS,AAAT,IAIF,CAFa,AAEZ,MAFkB,EAAA,EAER,MAFgB,CAAC,iBAAiB,CAAC,GAGhD,MAAO,CAAE,SAAS,EAAO,MAAO,oBAAqB,EAKvD,MAFA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,cAER,CAAE,SAAS,CAAK,CACzB,CAAE,MAAO,EAAO,CAEd,OADA,QAAQ,KAAK,CAAC,gCAAiC,GACxC,CAAE,QAAS,GAAO,MAAO,2BAA4B,CAC9D,CACF,0CAlGsB,EAkBA,EAmBA,EAiBA,EA2BA,IAjFA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAkBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAmBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAiBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA2BA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,mLCtFtB,IAAA,EAAA,EAAA,CAAA,CAAA,MACA,eAAe,IACR,CAAC,MAAM,CAAA,EAAA,EAAA,OAAA,AAAO,GAAA,CAAE,CAAE,MAAM,CAAC,CAAC,gCAAgC,EAAE,KAAK,GAAG,GAAA,CAAI,CAC/E,0CAEE,IAAA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,mECNF,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEA,EAAA,EAAA,CAAA,CAAA,OAQA,EAAA,EAAA,CAAA,CAAA,OAKA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA","ignoreList":[2]}