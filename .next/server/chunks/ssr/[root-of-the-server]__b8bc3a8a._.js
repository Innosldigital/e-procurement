module.exports=[94391,a=>{"use strict";var b=a.i(26046);let c=new b.Schema({supplierId:{type:String,required:!0,unique:!0},name:{type:String,required:!0},approved:{type:Boolean,default:!1},ownerUserId:{type:String,required:!0,index:!0},segment:{type:String},category:{type:String},region:{type:String},onboarding:{contactPerson:String,phone:String,email:String,goodsType:String,productCategories:[String],supplyAreas:[String],deliveryTimeline:String,priceListUploads:[{name:String,size:Number,type:String}],registrationCertificateUploads:[{name:String,size:Number,type:String}],businessRegistrationCertificateUploads:[{name:String,size:Number,type:String}],taxClearanceCertificateUploads:[{name:String,size:Number,type:String}],gstVatRegistrationCertificateUploads:[{name:String,size:Number,type:String}],businessLicenseUploads:[{name:String,size:Number,type:String}],nassitCertificateUploads:[{name:String,size:Number,type:String}],sectorSpecificCertificateUploads:[{name:String,size:Number,type:String}],paymentMethods:[String],bankDetails:{bankName:String,accountName:String,accountNumber:String,prefersCash:Boolean},declarations:{infoAccurate:Boolean,agreeRules:Boolean}},risk:{type:String,enum:["Low","Medium","High","Under review"]},onTimePerformance:{type:Number},fy24Spend:{type:Number},performanceScore:{type:Number},riskStatus:{type:String},primaryCategory:{type:String},commercialTerms:{paymentTerms:String,diversityStatus:String},performanceMetrics:{deliveryPerformance:{onTime:Number,avgLeadTime:Number,lateDeliveries:Number},qualityMetrics:{returnRate:Number,qualityIncidents:Number,criticalEvents:Number},financialMetrics:{externalRating:String,creditLimit:Number,overdueInvoices:Boolean,paymentAge:Number},complianceStatus:{kyc:String,aml:String,insuranceCerts:Boolean,sanctions:String}},contacts:[{role:String,name:String,email:String,phone:String}],documents:[{name:String,type:String,size:String,signedDate:String,expiresDate:String,owner:String}],recentActivity:[{event:String,date:String,owner:String}]},{timestamps:!0}),d=b.models.Supplier||(0,b.model)("Supplier",c);a.s(["Supplier",0,d])},20724,a=>{"use strict";var b=a.i(37936),c=a.i(18558),d=a.i(22017),e=a.i(94391);async function f(){try{await (0,d.default)();let a=await e.Supplier.find({approved:!0}).sort({performanceScore:-1}).limit(50).lean();return{success:!0,data:JSON.parse(JSON.stringify(a))}}catch(a){return console.error("[v0] Error fetching suppliers:",a),{success:!1,error:"Failed to fetch suppliers"}}}async function g(a){try{await (0,d.default)();let b=await e.Supplier.findById(a).lean();if(!b)return{success:!1,error:"Supplier not found"};return{success:!0,data:JSON.parse(JSON.stringify(b))}}catch(a){return console.error("[v0] Error fetching supplier:",a),{success:!1,error:"Failed to fetch supplier"}}}async function h(a){try{await (0,d.default)();let b=await e.Supplier.create(a);return(0,c.revalidatePath)("/suppliers"),{success:!0,data:JSON.parse(JSON.stringify(b))}}catch(a){return console.error("[v0] Error creating supplier:",a),{success:!1,error:"Failed to create supplier"}}}async function i(a,b){try{await (0,d.default)();let f=await e.Supplier.findByIdAndUpdate(a,b,{new:!0}).lean();if(!f)return{success:!1,error:"Supplier not found"};return(0,c.revalidatePath)("/suppliers"),(0,c.revalidatePath)(`/suppliers/${a}`),{success:!0,data:JSON.parse(JSON.stringify(f))}}catch(a){return console.error("[v0] Error updating supplier:",a),{success:!1,error:"Failed to update supplier"}}}async function j(a){try{if(await (0,d.default)(),!await e.Supplier.findByIdAndDelete(a))return{success:!1,error:"Supplier not found"};return(0,c.revalidatePath)("/suppliers"),{success:!0}}catch(a){return console.error("[v0] Error deleting supplier:",a),{success:!1,error:"Failed to delete supplier"}}}(0,a.i(13095).ensureServerEntryExports)([f,g,h,i,j]),(0,b.registerServerReference)(f,"00acbb6e695774d924e05f0e0a179080700111a9b9",null),(0,b.registerServerReference)(g,"4090a6d6e078357e2bcc2a50582c33127f1c659dc5",null),(0,b.registerServerReference)(h,"405b16f9390feda0d57de1367cf250e9c37ac3cbe5",null),(0,b.registerServerReference)(i,"600f467f1c11cdae2c2ca3ff1554bd9b8b6f59ca58",null),(0,b.registerServerReference)(j,"402da2b8281da70c47f8f561ab861bf4babffafea8",null),a.s(["createSupplier",()=>h,"deleteSupplier",()=>j,"getSupplierById",()=>g,"getSuppliers",()=>f,"updateSupplier",()=>i])},27607,a=>{"use strict";var b=a.i(37936);a.i(44721);var c=a.i(5246);async function d(){(await (0,c.cookies)()).delete(`__clerk_invalidate_cache_cookie_${Date.now()}`)}(0,a.i(13095).ensureServerEntryExports)([d]),(0,b.registerServerReference)(d,"7f7028896c8082e0c1f396f4d9a06959ec42b1d08a",null),a.s(["invalidateCacheAction",()=>d])},78500,(a,b,c)=>{b.exports=a.x("node:async_hooks",()=>require("node:async_hooks"))},16477,a=>{"use strict";a.i(48917);var b=a.i(87691),c=a.i(24202),d=a.i(75582),e=a.i(63365);let f=new(a.i(78500)).AsyncLocalStorage;var g=a.i(54772);let h=async()=>{var a,h;let i;try{let a=await (0,c.buildRequestLike)(),d=(0,e.getHeader)(a,b.constants.Headers.ClerkRequestData);i=(0,g.decryptClerkRequestData)(d)}catch(a){if(a&&(0,c.isPrerenderingBailout)(a))throw a}let j=null!=(h=null==(a=f.getStore())?void 0:a.get("requestData"))?h:i;return(null==j?void 0:j.secretKey)||(null==j?void 0:j.publishableKey)?(0,d.createClerkClientWithOptions)(j):(0,d.createClerkClientWithOptions)({})};a.s(["clerkClient",()=>h],16477)},48935,a=>{"use strict";var b=a.i(26046);let c=new b.Schema({companyId:{type:String,required:!0,unique:!0},name:{type:String,required:!0},approved:{type:Boolean,default:!1},industry:{type:String},region:{type:String},size:{type:String},contactEmail:{type:String},ownerUserId:{type:String,required:!0,index:!0},onboarding:{companyInformation:{organizationType:String,address:String,officialEmail:String,phone:String,website:String},contactPerson:{name:String,role:String,phone:String,email:String},businessOperations:{description:String,hasBranches:Boolean,numberOfBranches:Number,branchLocations:String,centralStore:String},procurementStructure:{currentMethod:String,requiresApprovalWorkflows:Boolean,approvalLevels:[String],manager:{name:String,position:String,email:String}},userSetup:{employeeAccessCount:String,departments:[String],otherDepartment:String},documents:{registrationUploads:[{name:String,size:Number,type:String}],tin:String,logoUploads:[{name:String,size:Number,type:String}]},systemConfiguration:{vendorsSelfOnboard:String,tenderingEnabled:Boolean,eInvoicingEnabled:Boolean,analyticsEnabled:Boolean},responsibilities:{systemManagerName:String,systemManagerRole:String,invoicesApprover:String,poApprover:String,goodsReceiver:String},teamMembers:{projectLead:String,trainingOfficer:String},declarations:{infoAccurate:Boolean,agreeOnboarding:Boolean}}},{timestamps:!0}),d=b.models.Company||(0,b.model)("Company",c);a.s(["Company",0,d])},44367,a=>{"use strict";var b=a.i(26022),c=a.i(27607),d=a.i(85978),e=a.i(74377),f=a.i(43386),g=a.i(22752),h=a.i(20724),i=a.i(24622),j=a.i(41783),k=a.i(37936),l=a.i(18558),m=a.i(5072),n=a.i(16477),o=a.i(22017),p=a.i(94391),q=a.i(48935);async function r(a){try{let{userId:b}=await (0,m.auth)();if(!b)return{success:!1,error:"Unauthorized"};await (0,o.default)();let c=await q.Company.countDocuments(),d=`COMP-${(c+1e3).toString()}`;await q.Company.create({companyId:d,name:a.companyName,approved:!1,industry:a.industry||"",region:a.region||"",size:a.size||"",contactEmail:a.contactEmail||"",ownerUserId:b,onboarding:{companyInformation:{organizationType:a.organizationType||"",address:a.address||"",officialEmail:a.officialEmail||"",phone:a.companyPhone||"",website:a.website||""},contactPerson:{name:a.contactPersonName||"",role:a.contactPersonRole||"",phone:a.contactPersonPhone||"",email:a.contactPersonEmail||""},businessOperations:{description:a.businessDescription||"",hasBranches:!!a.hasBranches,numberOfBranches:"number"==typeof a.numberOfBranches?a.numberOfBranches:0,branchLocations:a.branchLocations||"",centralStore:a.centralStore||""},procurementStructure:{currentMethod:a.procurementMethod||"",requiresApprovalWorkflows:!!a.requiresApprovalWorkflows,approvalLevels:Array.isArray(a.approvalLevels)?a.approvalLevels:[],manager:{name:a.managerName||"",position:a.managerPosition||"",email:a.managerEmail||""}},userSetup:{employeeAccessCount:a.employeeAccessCount||"",departments:Array.isArray(a.departments)?a.departments:[],otherDepartment:a.otherDepartment||""},documents:{registrationUploads:Array.isArray(a.registrationUploads)?a.registrationUploads:[],tin:a.tin||"",logoUploads:Array.isArray(a.logoUploads)?a.logoUploads:[]},systemConfiguration:{vendorsSelfOnboard:a.vendorsSelfOnboard||"",tenderingEnabled:!!a.tenderingEnabled,eInvoicingEnabled:!!a.eInvoicingEnabled,analyticsEnabled:!!a.analyticsEnabled},responsibilities:{systemManagerName:a.systemManagerName||"",systemManagerRole:a.systemManagerRole||"",invoicesApprover:a.invoicesApprover||"",poApprover:a.poApprover||"",goodsReceiver:a.goodsReceiver||""},teamMembers:{projectLead:a.projectLead||"",trainingOfficer:a.trainingOfficer||""},declarations:{infoAccurate:!!a.declarationInfoAccurate,agreeOnboarding:!!a.declarationAgreeOnboarding}}});let e=await (0,n.clerkClient)();return await e.users.updateUser(b,{publicMetadata:{role:"company",companyId:d,onboardingStatus:"pending_admin_approval",company:{name:a.companyName,industry:a.industry||"",region:a.region||"",size:a.size||"",contactEmail:a.contactEmail||""},onboarded:!1}}),(0,l.revalidatePath)("/onboarding"),{success:!0,data:{companyId:d}}}catch(a){return{success:!1,error:"Failed to submit company onboarding"}}}async function s(a){try{let{userId:b}=await (0,m.auth)();if(!b)return{success:!1,error:"Unauthorized"};await (0,o.default)();let c=await p.Supplier.countDocuments(),d=`SUP-${(c+5e3).toString()}`,e=await p.Supplier.create({supplierId:d,name:a.name,approved:!1,ownerUserId:b,category:a.category||"General",region:a.region||"Global",segment:a.segment||"Standard",onboarding:{contactPerson:a.contactPerson||"",phone:a.phone||"",email:a.email||"",goodsType:a.goodsType||"",productCategories:Array.isArray(a.productCategories)?a.productCategories:[],supplyAreas:Array.isArray(a.supplyAreas)?a.supplyAreas:[],deliveryTimeline:a.deliveryTimeline||"",priceListUploads:Array.isArray(a.priceListUploads)?a.priceListUploads:[],registrationCertificateUploads:Array.isArray(a.registrationCertificateUploads)?a.registrationCertificateUploads:[],businessRegistrationCertificateUploads:Array.isArray(a.businessRegistrationCertificateUploads)?a.businessRegistrationCertificateUploads:[],taxClearanceCertificateUploads:Array.isArray(a.taxClearanceCertificateUploads)?a.taxClearanceCertificateUploads:[],gstVatRegistrationCertificateUploads:Array.isArray(a.gstVatRegistrationCertificateUploads)?a.gstVatRegistrationCertificateUploads:[],businessLicenseUploads:Array.isArray(a.businessLicenseUploads)?a.businessLicenseUploads:[],nassitCertificateUploads:Array.isArray(a.nassitCertificateUploads)?a.nassitCertificateUploads:[],sectorSpecificCertificateUploads:Array.isArray(a.sectorSpecificCertificateUploads)?a.sectorSpecificCertificateUploads:[],paymentMethods:Array.isArray(a.paymentMethods)?a.paymentMethods:[],bankDetails:{bankName:a.bankDetails?.bankName||"",accountName:a.bankDetails?.accountName||"",accountNumber:a.bankDetails?.accountNumber||"",prefersCash:!!a.bankDetails?.prefersCash},declarations:{infoAccurate:!!a.declarations?.infoAccurate,agreeRules:!!a.declarations?.agreeRules}},performanceScore:0,riskRating:"Low",totalSpend:0}),f=await (0,n.clerkClient)();return await f.users.updateUser(b,{publicMetadata:{role:"supplier",supplierId:d,onboardingStatus:"pending_admin_approval",onboarded:!1}}),(0,l.revalidatePath)("/onboarding"),{success:!0,data:JSON.parse(JSON.stringify(e))}}catch(a){return{success:!1,error:"Failed to submit supplier onboarding"}}}(0,a.i(13095).ensureServerEntryExports)([r,s]),(0,k.registerServerReference)(r,"40e1380f2fa032e21cd2a6862c3a2d3aac8c912d09",null),(0,k.registerServerReference)(s,"40616a4b4ee43e0688b9ea01e98948438bcb755c6c",null),a.s([],32960),a.i(32960),a.s(["002a32689d17cb2cb93efe0d9a0dde8c0edec41c9c",()=>e.markAllAsRead,"00acbb6e695774d924e05f0e0a179080700111a9b9",()=>h.getSuppliers,"00be20e6109a2a8bfeb45dc52d89ce9cb3529fad93",()=>j.getApprovals,"00e7b4a1c132478642418d345503f4c53bdb390c9c",()=>e.getUnreadCount,"00e9a018658eb7e03331b6cc284e99f89a37d0d11b",()=>g.getPurchaseOrders,"00edf2497aa68ccbd564b9525e653a469b4a592936",()=>i.getInvoices,"00f4030896116c02808b53faf984df59a1de335173",()=>f.getRequisitions,"4012a4770a5fca10e2a3ff1d52fc6907455ac5eee8",()=>e.markAsRead,"4038dfb1dece52774e405a3da827c0072c4eb6aa73",()=>e.getNotifications,"40616a4b4ee43e0688b9ea01e98948438bcb755c6c",()=>s,"4063e6dc301d47e91bde494afbc0d7a04d3079b4db",()=>e.deleteNotification,"40e1380f2fa032e21cd2a6862c3a2d3aac8c912d09",()=>r,"7f07616d1842b196e75d3764badc0c908a989af9f9",()=>b.deleteKeylessAction,"7f1dbd68cb8e312051904c740c31183700f8d1735b",()=>b.detectKeylessEnvDriftAction,"7f1ede8bc9d9446f8123ff7d3c19d928c3e8517cde",()=>b.syncKeylessConfigAction,"7f7028896c8082e0c1f396f4d9a06959ec42b1d08a",()=>c.invalidateCacheAction,"7f770e265b733918dbea7c626386b020f2422cfea4",()=>d.formatMetadataHeaders,"7f8d998a6efbd0c4b96f44e255714ffadbe9a58ab2",()=>b.createOrReadKeylessAction,"7fcb3eace087d4a182205618daa34bbc74fd3410aa",()=>d.collectKeylessMetadata],44367)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__b8bc3a8a._.js.map